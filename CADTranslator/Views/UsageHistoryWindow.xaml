<ui:FluentWindow x:Class="CADTranslator.Views.UsageHistoryWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:vm="clr-namespace:CADTranslator.ViewModels"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 mc:Ignorable="d"
                 Title="翻译使用记录"
                 Height="600"
                 Width="950"
                 WindowStartupLocation="CenterOwner"
                 WindowBackdropType="Mica"
                 ExtendsContentIntoTitleBar="True"
                 d:DataContext="{d:DesignInstance Type=vm:UsageHistoryViewModel, IsDesignTimeCreatable=False}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ui:ThemesDictionary Theme="Light" />
                <ui:ControlsDictionary />
            </ResourceDictionary.MergedDictionaries>
            <Style x:Key="DataGridColumnHeaderStyleWithBorders"
                   TargetType="{x:Type DataGridColumnHeader}"
                   BasedOn="{StaticResource {x:Type DataGridColumnHeader}}">
                <Setter Property="Padding"
                        Value="10,0,40,0" />
                <Setter Property="BorderBrush"
                        Value="SkyBlue" />
                <Setter Property="Width"
                        Value="Auto" />
                <Setter Property="VerticalAlignment"
                        Value="Center" />
                <Setter Property="HorizontalAlignment"
                        Value="Center" />
                <Setter Property="BorderThickness"
                        Value="0,0,1,1" />
            </Style>
            <Style TargetType="{x:Type DataGridCell}"
                   BasedOn="{StaticResource {x:Type DataGridCell}}">
                <Setter Property="Padding"
                        Value="5,0,15,0" />
                <Setter Property="Focusable"
                        Value="False" />
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="10,0,10,10">
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ui:TitleBar Grid.Row="0"
                     CanMaximize="True"
                     ApplicationTheme="Light" />

        <ui:DataGrid Name="HistoryDataGrid"
                     Grid.Row="1"
                     ItemsSource="{Binding HistoryDataTable}"
                     AutoGenerateColumns="True"
                     IsReadOnly="True"
                     SelectionMode="Extended"
                     Background="Transparent"
                     ScrollViewer.HorizontalScrollBarVisibility="Auto"
                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                     AutoGeneratingColumn="HistoryDataGrid_AutoGeneratingColumn"
                     HeadersVisibility="All"
                     BorderThickness="1"
                     CanUserResizeColumns="True"
                     BorderBrush="SkyBlue"
                     GridLinesVisibility="All" />

        <Border Grid.Row="2"
                BorderThickness="0,1,0,0"
                BorderBrush="{DynamicResource ControlElevationBorderBrush}"
                Padding="0,15,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0"
                            Orientation="Horizontal"
                            VerticalAlignment="Center">
                    <TextBlock Text="筛选接口:"
                               VerticalAlignment="Center"
                               Margin="0,0,10,0"
                               Opacity="0.8" />
                    <ComboBox ItemsSource="{Binding ApiFilterOptions}"
                              SelectedItem="{Binding SelectedApiFilter}"
                              Width="180" />
                </StackPanel>

                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                    <TextBlock Text="总计段落数: "
                               FontWeight="SemiBold" />
                    <TextBlock Text="{Binding TotalParagraphs}"
                               Margin="0,0,15,0" />
                    <TextBlock Text="总耗时(秒): "
                               FontWeight="SemiBold" />
                    <TextBlock Text="{Binding TotalDuration, StringFormat={}{0:F1}}"
                               Margin="0,0,15,0" />
                    <TextBlock Text="总译文(字): "
                               FontWeight="SemiBold" />
                    <TextBlock Text="{Binding TotalCharacters}" />
                </StackPanel>

                <ui:Button Grid.Column="2"
                           Content="关闭"
                           Command="{Binding CloseCommand}"
                           CommandParameter="{Binding RelativeSource={RelativeSource AncestorType=Window}}"
                           Margin="20,0,0,0"
                           IsCancel="True" />
            </Grid>
        </Border>
    </Grid>
</ui:FluentWindow>