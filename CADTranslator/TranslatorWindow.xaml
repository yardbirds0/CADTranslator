<Window x:Class="CADTranslator.TranslatorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="CAD智能翻译器"
        Height="700"
        Width="1100"
        FontFamily="Microsoft YaHei UI"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        SourceInitialized="Window_SourceInitialized">

    <Window.Resources>
        <Style TargetType="Button"
               x:Key="ControlButton">
            <Setter Property="Background"
                    Value="#33FFFFFF" />
            <Setter Property="Foreground"
                    Value="#FFE2E2E2" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="Padding"
                    Value="10,5" />
            <Setter Property="Margin"
                    Value="0,5,0,5" />
            <Setter Property="Cursor"
                    Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver"
                         Value="True">
                    <Setter Property="Background"
                            Value="#44FFFFFF" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border Background="#AA2F2F2F"
            CornerRadius="10"
            BorderBrush="#22000000"
            BorderThickness="1"
            MouseLeftButtonDown="Border_MouseLeftButtonDown">
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <StackPanel Orientation="Horizontal"
                        Grid.Row="0">
                <TextBlock Text="CAD 智能翻译器"
                           Foreground="White"
                           FontSize="16"
                           VerticalAlignment="Center" />
                <Button Content="✕"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top"
                        Margin="850,0,0,0"
                        Width="30"
                        Height="30"
                        FontSize="14"
                        FontWeight="Bold"
                        Foreground="Gray"
                        Background="Transparent"
                        BorderThickness="0"
                        Click="CloseButton_Click"
                        ToolTip="关闭" />
            </StackPanel>

            <Grid Grid.Row="1"
                  Margin="0,10,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="260" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0"
                            Margin="0,0,10,0">
                    <GroupBox Header="翻译设置"
                              Foreground="White">
                        <StackPanel>
                            <Label Content="API Key"
                                   Foreground="White" />
                            <PasswordBox x:Name="txtApiKey" />
                        </StackPanel>
                    </GroupBox>
                    <GroupBox Header="排版设置"
                              Foreground="White"
                              Margin="0,10,0,0">
                        <StackPanel>
                            <CheckBox x:Name="chkEnableFormatting"
                                      Content="启用智能排版"
                                      IsChecked="True"
                                      Foreground="White" />
                            <Label Content="每行最大字符数"
                                   Foreground="White" />
                            <TextBox x:Name="txtMaxCharsPerLine"
                                     Text="30" />
                            <Label Content="后续行缩进字符数"
                                   Foreground="White" />
                            <TextBox x:Name="txtIndentChars"
                                     Text="2" />
                            <Label Content="行间距系数"
                                   Foreground="White" />
                            <TextBox x:Name="txtLineSpacing"
                                     Text="1.5" />
                        </StackPanel>
                    </GroupBox>
                    <Button Content="全部翻译"
                            Style="{StaticResource ControlButton}"
                            Click="BtnTranslate_Click" />
                    <Button Content="应用到CAD"
                            Style="{StaticResource ControlButton}"
                            Click="BtnApplyToCAD_Click" />
                    <Button Content="Jig预览并放置"
                            Style="{StaticResource ControlButton}"
                            Click="BtnJigPreview_Click" />

                    <Separator Margin="0,10,0,0" />
                    <Button Content="文字智能排版"
                            Style="{StaticResource ControlButton}"
                            Click="BtnSmartLayout_Click" />
                    <Button Content="动态排版 (Jig版)"
                            Style="{StaticResource ControlButton}"
                            Click="BtnJigLayout_Click" />
                </StackPanel>

                <DockPanel Grid.Column="1">
                    <StackPanel Orientation="Horizontal"
                                DockPanel.Dock="Top"
                                Margin="0,0,0,5">
                        <Button Content="合并选中行"
                                Style="{StaticResource ControlButton}"
                                Margin="0"
                                Click="BtnMerge_Click" />
                        <Button Content="拆分选中行"
                                Style="{StaticResource ControlButton}"
                                Margin="5,0,0,0"
                                Click="BtnSplit_Click" />
                        <Button Content="新增空行"
                                Style="{StaticResource ControlButton}"
                                Margin="5,0,0,0"
                                Click="BtnAdd_Click" />
                        <Button Content="删除选中行"
                                Style="{StaticResource ControlButton}"
                                Margin="5,0,0,0"
                                Click="BtnDelete_Click" />
                    </StackPanel>
                    <DataGrid x:Name="dataGridBlocks"
                              AutoGenerateColumns="False"
                              CanUserAddRows="False"
                              SelectionMode="Extended"
                              MouseDoubleClick="DataGrid_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID"
                                                Binding="{Binding Id}"
                                                Width="50"
                                                IsReadOnly="True" />
                            <DataGridTextColumn Header="原文"
                                                Binding="{Binding OriginalText}"
                                                Width="*"
                                                IsReadOnly="True" />
                            <DataGridTextColumn Header="译文"
                                                Binding="{Binding TranslatedText, UpdateSourceTrigger=PropertyChanged}"
                                                Width="2*" />
                        </DataGrid.Columns>
                    </DataGrid>
                </DockPanel>
            </Grid>
        </Grid>
    </Border>
</Window>